

```python
import io
from urllib.parse import urlparse

import requests
from flask import Flask, Response, abort, request

app = Flask(__name__)

ALLOWED_CONTENT_TYPES = {
    "image/jpeg",
    "image/png",
    "image/gif",
    "image/webp",
    "image/svg+xml",
    "image/bmp",
    "image/tiff",
    "image/x-icon",
    "image/vnd.microsoft.icon",
}

MAX_IMAGE_SIZE = 10 * 1024 * 1024  # 10 MB
REQUEST_TIMEOUT = 10  # seconds


def _is_valid_url(url: str) -> bool:
    """Validate that the URL is a proper HTTP(S) URL and not a private/internal address."""
    try:
        parsed = urlparse(url)
    except ValueError:
        return False

    if parsed.scheme not in ("http", "https"):
        return False

    if not parsed.hostname:
        return False

    # Block common private/loopback hostnames
    blocked_hosts = {"localhost", "127.0.0.1", "0.0.0.0", "::1"}
    if parsed.hostname.lower() in blocked_hosts:
        return False

    return True


@app.route("/api/image-proxy", methods=["GET"])
def image_proxy():
    """Fetch a remote image and serve it to the client to avoid mixed-content warnings."""
    url = request.args.get("url")

    if not url:
        abort(400, description="Missing required query parameter: 'url'")

    if not _is_valid_url(url):
        abort(400, description="Invalid or disallowed URL")

    try:
        upstream_resp = requests.get(
            url,
            timeout=REQUEST_TIMEOUT,
            stream=True,
            headers={
                "User-Agent": "ImageProxy/1.0",
                "Accept": "image/*",
            },
        )
        upstream_resp.raise_for_status()
    except requests.exceptions.Timeout:
        abort(504, description="Upstream image request timed out")
    except requests.exceptions.ConnectionError:
        abort(502, description="Could not connect to upstream image server")
    except requests.exceptions.HTTPError as exc:
        abort(502, description=f"Upstream server returned an error: {exc.response.status_code}")
    except requests.exceptions.RequestException:
        abort(502, description="Failed to fetch the upstream image")

    content_type = upstream_resp.headers.get("Content-Type", "").split(";")[0].strip().lower()
    if content_type not in ALLOWED_CONTENT_TYPES:
        upstream_resp.close()
        abort(400, description=f"Unsupported content type: {content_type}")

    # Read the image data with a size limit
    chunks = []
    bytes_read = 0
    for chunk in upstream_resp.iter_content(chunk_size=8192):
        bytes_read += len(chunk)
        if bytes_read > MAX_IMAGE_SIZE:
            upstream_resp.close()
            abort(413, description="Upstream image exceeds maximum allowed size")
        chunks.append(chunk)

    upstream_resp.close()
    image_data = b"".join(chunks)

    response = Response(image_data, content_type=content_type)
    response.headers["Cache-Control"] = "public, max-age=86400"
    response.headers["X-Content-Type-Options"] = "nosniff"
    response.headers["Content-Length"] = str(len(image_data))

    return response


if __name__ == "__main__":
    app.run(debug=True, host="0.0.0.0", port=5000)
```