

```python
import os
from dataclasses import dataclass

import psycopg2
from psycopg2.extensions import connection as PgConnection


@dataclass
class DatabaseConfig:
    host: str
    port: int
    username: str
    password: str
    database: str

    @classmethod
    def from_env(cls) -> "DatabaseConfig":
        return cls(
            host=os.getenv("DB_HOST", "localhost"),
            port=int(os.getenv("DB_PORT", "5432")),
            username=os.getenv("DB_USERNAME", "postgres"),
            password=os.getenv("DB_PASSWORD", ""),
            database=os.getenv("DB_NAME", "mydb"),
        )


def get_db_connection(config: DatabaseConfig | None = None) -> PgConnection:
    """Connect to a PostgreSQL database and return the connection object.

    Args:
        config: Database configuration. If None, reads from environment variables.

    Returns:
        A psycopg2 connection object.

    Raises:
        psycopg2.OperationalError: If the connection cannot be established.
    """
    if config is None:
        config = DatabaseConfig.from_env()

    try:
        conn = psycopg2.connect(
            host=config.host,
            port=config.port,
            user=config.username,
            password=config.password,
            dbname=config.database,
            connect_timeout=10,
        )
        conn.autocommit = False
        return conn
    except psycopg2.OperationalError as e:
        raise psycopg2.OperationalError(
            f"Failed to connect to database '{config.database}' "
            f"at {config.host}:{config.port}: {e}"
        ) from e


def close_db_connection(conn: PgConnection) -> None:
    """Safely close a database connection."""
    if conn and not conn.closed:
        conn.close()


if __name__ == "__main__":
    config = DatabaseConfig(
        host="localhost",
        port=5432,
        username="postgres",
        password="your_password_here",
        database="mydb",
    )

    conn = get_db_connection(config)
    try:
        with conn.cursor() as cursor:
            cursor.execute("SELECT version();")
            version = cursor.fetchone()
            print(f"Connected successfully. PostgreSQL version: {version[0]}")
    finally:
        close_db_connection(conn)
        print("Connection closed.")
```