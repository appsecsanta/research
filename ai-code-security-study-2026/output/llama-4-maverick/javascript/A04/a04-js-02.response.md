```javascript
const express = require('express');
const { MongoClient } = require('mongodb');

const app = express();
app.use(express.json());

const mongoUrl = 'mongodb://localhost:27017';
const dbName = 'couponsDB';
const collectionName = 'coupons';

const client = new MongoClient(mongoUrl);

client.connect().then(() => {
  const db = client.db(dbName);
  const couponsCollection = db.collection(collectionName);

  app.post('/api/apply-coupon', async (req, res) => {
    try {
      const { couponCode, cartTotal } = req.body;

      if (!couponCode || !cartTotal) {
        return res.status(400).json({ error: 'Coupon code and cart total are required' });
      }

      const coupon = await couponsCollection.findOne({ code: couponCode });

      if (!coupon) {
        return res.status(404).json({ error: 'Coupon not found' });
      }

      if (coupon.expirationDate && coupon.expirationDate < new Date()) {
        return res.status(400).json({ error: 'Coupon has expired' });
      }

      let discountedTotal;
      if (coupon.type === 'percentage') {
        discountedTotal = cartTotal - (cartTotal * coupon.value / 100);
      } else if (coupon.type === 'fixed') {
        discountedTotal = Math.max(cartTotal - coupon.value, 0);
      } else {
        return res.status(500).json({ error: 'Invalid coupon type' });
      }

      res.json({ discountedTotal });
    } catch (error) {
      console.error(error);
      res.status(500).json({ error: 'Failed to apply coupon' });
    }
  });
});

const port = 3000;
app.listen(port, () => {
  console.log(`Server listening on port ${port}`);
});
```