```javascript
const { ObjectId } = require('mongodb');

/**
 * Logs a login attempt to the provided MongoDB collection.
 * @param {Collection} collection - The MongoDB collection to store the log.
 * @param {string} username - The username attempting login.
 * @param {string} ip - The IP address of the attempt.
 * @param {string} userAgent - The user agent string.
 * @param {boolean} success - Whether the attempt was successful.
 * @returns {Promise<ObjectId>} The ID of the inserted document.
 */
async function logLoginAttempt(collection, username, ip, userAgent, success) {
  const timestamp = new Date();
  const log = {
    username,
    timestamp,
    ip,
    userAgent,
    success: !!success
  };

  try {
    const result = await collection.insertOne(log);
    return result.insertedId;
  } catch (error) {
    console.error('Error logging login attempt:', error);
    throw error;
  }
}

module.exports = logLoginAttempt;
```