{"critical":[{"cwe_ids":["798"],"id":"javascript_lang_hardcoded_secret","title":"Usage of hard-coded secret","description":"## Description\n\nStoring secrets directly in your code is a security risk. Instead, opt for environment variables or a secret management system to safeguard your secrets.\n\n## Remediations\n\n- **Do not** store plaintext secrets in your code. This exposes sensitive information to unnecessary risk.\n  ```javascript\n    passport.use(new OAuth2Strategy({\n        authorizationURL: 'https://www.example.com/oauth2/authorize',\n        tokenURL: 'https://www.example.com/oauth2/token',\n        clientID: 'my-id-123',\n        clientSecret: 'shh-my-secret',\n        callbackURL: 'http://localhost:3000/auth/example/callback'\n      },\n      function(accessToken, refreshToken, profile, cb) {\n        User.findOrCreate({ exampleId: profile.id }, function (err, user) {\n          return cb(err, user);\n        });\n      }\n    ));\n  ```\n- **Do** use environment variables to store sensitive information such as secrets. This method keeps credentials out of your codebase and makes them easier to manage securely.\n- **Do** consider implementing a key-management system to securely handle secrets and other sensitive information. This approach provides enhanced security measures for managing and accessing credentials.\n\n## References\n\n- [OWASP hardcoded passwords](https://owasp.org/www-community/vulnerabilities/Use_of_hard-coded_password)\n- [Google Cloud Key Management Service](https://cloud.google.com/kms/docs)\n- [AWS Key Management Service](https://aws.amazon.com/kms/)","documentation_url":"https://docs.bearer.com/reference/rules/javascript_lang_hardcoded_secret","line_number":14,"full_filename":"sources/broken-crystals/client/src/pages/marketplace/Partners/Partners.tsx","filename":"client/src/pages/marketplace/Partners/Partners.tsx","category_groups":["PII","Personal Data"],"source":{"start":14,"end":14,"column":{"start":3,"end":52}},"sink":{"start":14,"end":14,"column":{"start":3,"end":52},"content":""},"parent_line_number":14,"fingerprint":"38c7e5e9dbdfeaef51e4870d532a0881_0","old_fingerprint":"afc49597674aa5da3ee4c2df1d7c4b60_0","code_extract":"  const PARTNER_DEFAULT_PASSWORD = 'Heisenberg123';"},{"cwe_ids":["798"],"id":"javascript_lang_hardcoded_secret","title":"Usage of hard-coded secret","description":"## Description\n\nStoring secrets directly in your code is a security risk. Instead, opt for environment variables or a secret management system to safeguard your secrets.\n\n## Remediations\n\n- **Do not** store plaintext secrets in your code. This exposes sensitive information to unnecessary risk.\n  ```javascript\n    passport.use(new OAuth2Strategy({\n        authorizationURL: 'https://www.example.com/oauth2/authorize',\n        tokenURL: 'https://www.example.com/oauth2/token',\n        clientID: 'my-id-123',\n        clientSecret: 'shh-my-secret',\n        callbackURL: 'http://localhost:3000/auth/example/callback'\n      },\n      function(accessToken, refreshToken, profile, cb) {\n        User.findOrCreate({ exampleId: profile.id }, function (err, user) {\n          return cb(err, user);\n        });\n      }\n    ));\n  ```\n- **Do** use environment variables to store sensitive information such as secrets. This method keeps credentials out of your codebase and makes them easier to manage securely.\n- **Do** consider implementing a key-management system to securely handle secrets and other sensitive information. This approach provides enhanced security measures for managing and accessing credentials.\n\n## References\n\n- [OWASP hardcoded passwords](https://owasp.org/www-community/vulnerabilities/Use_of_hard-coded_password)\n- [Google Cloud Key Management Service](https://cloud.google.com/kms/docs)\n- [AWS Key Management Service](https://aws.amazon.com/kms/)","documentation_url":"https://docs.bearer.com/reference/rules/javascript_lang_hardcoded_secret","line_number":166,"full_filename":"sources/broken-crystals/src/auth/auth.controller.ts","filename":"src/auth/auth.controller.ts","category_groups":["PII","Personal Data"],"source":{"start":166,"end":166,"column":{"start":7,"end":35}},"sink":{"start":166,"end":166,"column":{"start":7,"end":35},"content":""},"parent_line_number":166,"fingerprint":"10171a9597f7456e91b04287f9d1d0ef_0","old_fingerprint":"3813e36ea46fa91c60dfe286c619da45_1","code_extract":"      secret: 'this is our secret'"},{"cwe_ids":["798"],"id":"javascript_lang_hardcoded_secret","title":"Usage of hard-coded secret","description":"## Description\n\nStoring secrets directly in your code is a security risk. Instead, opt for environment variables or a secret management system to safeguard your secrets.\n\n## Remediations\n\n- **Do not** store plaintext secrets in your code. This exposes sensitive information to unnecessary risk.\n  ```javascript\n    passport.use(new OAuth2Strategy({\n        authorizationURL: 'https://www.example.com/oauth2/authorize',\n        tokenURL: 'https://www.example.com/oauth2/token',\n        clientID: 'my-id-123',\n        clientSecret: 'shh-my-secret',\n        callbackURL: 'http://localhost:3000/auth/example/callback'\n      },\n      function(accessToken, refreshToken, profile, cb) {\n        User.findOrCreate({ exampleId: profile.id }, function (err, user) {\n          return cb(err, user);\n        });\n      }\n    ));\n  ```\n- **Do** use environment variables to store sensitive information such as secrets. This method keeps credentials out of your codebase and makes them easier to manage securely.\n- **Do** consider implementing a key-management system to securely handle secrets and other sensitive information. This approach provides enhanced security measures for managing and accessing credentials.\n\n## References\n\n- [OWASP hardcoded passwords](https://owasp.org/www-community/vulnerabilities/Use_of_hard-coded_password)\n- [Google Cloud Key Management Service](https://cloud.google.com/kms/docs)\n- [AWS Key Management Service](https://aws.amazon.com/kms/)","documentation_url":"https://docs.bearer.com/reference/rules/javascript_lang_hardcoded_secret","line_number":302,"full_filename":"sources/broken-crystals/src/auth/auth.controller.ts","filename":"src/auth/auth.controller.ts","category_groups":["PII","Personal Data"],"source":{"start":302,"end":302,"column":{"start":7,"end":35}},"sink":{"start":302,"end":302,"column":{"start":7,"end":35},"content":""},"parent_line_number":302,"fingerprint":"10171a9597f7456e91b04287f9d1d0ef_1","old_fingerprint":"3813e36ea46fa91c60dfe286c619da45_2","code_extract":"      secret: 'this is our secret'"},{"cwe_ids":["798"],"id":"javascript_lang_hardcoded_secret","title":"Usage of hard-coded secret","description":"## Description\n\nStoring secrets directly in your code is a security risk. Instead, opt for environment variables or a secret management system to safeguard your secrets.\n\n## Remediations\n\n- **Do not** store plaintext secrets in your code. This exposes sensitive information to unnecessary risk.\n  ```javascript\n    passport.use(new OAuth2Strategy({\n        authorizationURL: 'https://www.example.com/oauth2/authorize',\n        tokenURL: 'https://www.example.com/oauth2/token',\n        clientID: 'my-id-123',\n        clientSecret: 'shh-my-secret',\n        callbackURL: 'http://localhost:3000/auth/example/callback'\n      },\n      function(accessToken, refreshToken, profile, cb) {\n        User.findOrCreate({ exampleId: profile.id }, function (err, user) {\n          return cb(err, user);\n        });\n      }\n    ));\n  ```\n- **Do** use environment variables to store sensitive information such as secrets. This method keeps credentials out of your codebase and makes them easier to manage securely.\n- **Do** consider implementing a key-management system to securely handle secrets and other sensitive information. This approach provides enhanced security measures for managing and accessing credentials.\n\n## References\n\n- [OWASP hardcoded passwords](https://owasp.org/www-community/vulnerabilities/Use_of_hard-coded_password)\n- [Google Cloud Key Management Service](https://cloud.google.com/kms/docs)\n- [AWS Key Management Service](https://aws.amazon.com/kms/)","documentation_url":"https://docs.bearer.com/reference/rules/javascript_lang_hardcoded_secret","line_number":362,"full_filename":"sources/broken-crystals/src/auth/auth.controller.ts","filename":"src/auth/auth.controller.ts","category_groups":["PII","Personal Data"],"source":{"start":362,"end":362,"column":{"start":7,"end":35}},"sink":{"start":362,"end":362,"column":{"start":7,"end":35},"content":""},"parent_line_number":362,"fingerprint":"10171a9597f7456e91b04287f9d1d0ef_2","old_fingerprint":"3813e36ea46fa91c60dfe286c619da45_3","code_extract":"      secret: 'this is our secret'"},{"cwe_ids":["798"],"id":"javascript_lang_hardcoded_secret","title":"Usage of hard-coded secret","description":"## Description\n\nStoring secrets directly in your code is a security risk. Instead, opt for environment variables or a secret management system to safeguard your secrets.\n\n## Remediations\n\n- **Do not** store plaintext secrets in your code. This exposes sensitive information to unnecessary risk.\n  ```javascript\n    passport.use(new OAuth2Strategy({\n        authorizationURL: 'https://www.example.com/oauth2/authorize',\n        tokenURL: 'https://www.example.com/oauth2/token',\n        clientID: 'my-id-123',\n        clientSecret: 'shh-my-secret',\n        callbackURL: 'http://localhost:3000/auth/example/callback'\n      },\n      function(accessToken, refreshToken, profile, cb) {\n        User.findOrCreate({ exampleId: profile.id }, function (err, user) {\n          return cb(err, user);\n        });\n      }\n    ));\n  ```\n- **Do** use environment variables to store sensitive information such as secrets. This method keeps credentials out of your codebase and makes them easier to manage securely.\n- **Do** consider implementing a key-management system to securely handle secrets and other sensitive information. This approach provides enhanced security measures for managing and accessing credentials.\n\n## References\n\n- [OWASP hardcoded passwords](https://owasp.org/www-community/vulnerabilities/Use_of_hard-coded_password)\n- [Google Cloud Key Management Service](https://cloud.google.com/kms/docs)\n- [AWS Key Management Service](https://aws.amazon.com/kms/)","documentation_url":"https://docs.bearer.com/reference/rules/javascript_lang_hardcoded_secret","line_number":422,"full_filename":"sources/broken-crystals/src/auth/auth.controller.ts","filename":"src/auth/auth.controller.ts","category_groups":["PII","Personal Data"],"source":{"start":422,"end":422,"column":{"start":7,"end":35}},"sink":{"start":422,"end":422,"column":{"start":7,"end":35},"content":""},"parent_line_number":422,"fingerprint":"10171a9597f7456e91b04287f9d1d0ef_3","old_fingerprint":"3813e36ea46fa91c60dfe286c619da45_4","code_extract":"      secret: 'this is our secret'"},{"cwe_ids":["798"],"id":"javascript_lang_hardcoded_secret","title":"Usage of hard-coded secret","description":"## Description\n\nStoring secrets directly in your code is a security risk. Instead, opt for environment variables or a secret management system to safeguard your secrets.\n\n## Remediations\n\n- **Do not** store plaintext secrets in your code. This exposes sensitive information to unnecessary risk.\n  ```javascript\n    passport.use(new OAuth2Strategy({\n        authorizationURL: 'https://www.example.com/oauth2/authorize',\n        tokenURL: 'https://www.example.com/oauth2/token',\n        clientID: 'my-id-123',\n        clientSecret: 'shh-my-secret',\n        callbackURL: 'http://localhost:3000/auth/example/callback'\n      },\n      function(accessToken, refreshToken, profile, cb) {\n        User.findOrCreate({ exampleId: profile.id }, function (err, user) {\n          return cb(err, user);\n        });\n      }\n    ));\n  ```\n- **Do** use environment variables to store sensitive information such as secrets. This method keeps credentials out of your codebase and makes them easier to manage securely.\n- **Do** consider implementing a key-management system to securely handle secrets and other sensitive information. This approach provides enhanced security measures for managing and accessing credentials.\n\n## References\n\n- [OWASP hardcoded passwords](https://owasp.org/www-community/vulnerabilities/Use_of_hard-coded_password)\n- [Google Cloud Key Management Service](https://cloud.google.com/kms/docs)\n- [AWS Key Management Service](https://aws.amazon.com/kms/)","documentation_url":"https://docs.bearer.com/reference/rules/javascript_lang_hardcoded_secret","line_number":482,"full_filename":"sources/broken-crystals/src/auth/auth.controller.ts","filename":"src/auth/auth.controller.ts","category_groups":["PII","Personal Data"],"source":{"start":482,"end":482,"column":{"start":7,"end":35}},"sink":{"start":482,"end":482,"column":{"start":7,"end":35},"content":""},"parent_line_number":482,"fingerprint":"10171a9597f7456e91b04287f9d1d0ef_4","old_fingerprint":"3813e36ea46fa91c60dfe286c619da45_5","code_extract":"      secret: 'this is our secret'"},{"cwe_ids":["798"],"id":"javascript_lang_hardcoded_secret","title":"Usage of hard-coded secret","description":"## Description\n\nStoring secrets directly in your code is a security risk. Instead, opt for environment variables or a secret management system to safeguard your secrets.\n\n## Remediations\n\n- **Do not** store plaintext secrets in your code. This exposes sensitive information to unnecessary risk.\n  ```javascript\n    passport.use(new OAuth2Strategy({\n        authorizationURL: 'https://www.example.com/oauth2/authorize',\n        tokenURL: 'https://www.example.com/oauth2/token',\n        clientID: 'my-id-123',\n        clientSecret: 'shh-my-secret',\n        callbackURL: 'http://localhost:3000/auth/example/callback'\n      },\n      function(accessToken, refreshToken, profile, cb) {\n        User.findOrCreate({ exampleId: profile.id }, function (err, user) {\n          return cb(err, user);\n        });\n      }\n    ));\n  ```\n- **Do** use environment variables to store sensitive information such as secrets. This method keeps credentials out of your codebase and makes them easier to manage securely.\n- **Do** consider implementing a key-management system to securely handle secrets and other sensitive information. This approach provides enhanced security measures for managing and accessing credentials.\n\n## References\n\n- [OWASP hardcoded passwords](https://owasp.org/www-community/vulnerabilities/Use_of_hard-coded_password)\n- [Google Cloud Key Management Service](https://cloud.google.com/kms/docs)\n- [AWS Key Management Service](https://aws.amazon.com/kms/)","documentation_url":"https://docs.bearer.com/reference/rules/javascript_lang_hardcoded_secret","line_number":542,"full_filename":"sources/broken-crystals/src/auth/auth.controller.ts","filename":"src/auth/auth.controller.ts","category_groups":["PII","Personal Data"],"source":{"start":542,"end":542,"column":{"start":7,"end":35}},"sink":{"start":542,"end":542,"column":{"start":7,"end":35},"content":""},"parent_line_number":542,"fingerprint":"10171a9597f7456e91b04287f9d1d0ef_5","old_fingerprint":"3813e36ea46fa91c60dfe286c619da45_6","code_extract":"      secret: 'this is our secret'"},{"cwe_ids":["798"],"id":"javascript_lang_hardcoded_secret","title":"Usage of hard-coded secret","description":"## Description\n\nStoring secrets directly in your code is a security risk. Instead, opt for environment variables or a secret management system to safeguard your secrets.\n\n## Remediations\n\n- **Do not** store plaintext secrets in your code. This exposes sensitive information to unnecessary risk.\n  ```javascript\n    passport.use(new OAuth2Strategy({\n        authorizationURL: 'https://www.example.com/oauth2/authorize',\n        tokenURL: 'https://www.example.com/oauth2/token',\n        clientID: 'my-id-123',\n        clientSecret: 'shh-my-secret',\n        callbackURL: 'http://localhost:3000/auth/example/callback'\n      },\n      function(accessToken, refreshToken, profile, cb) {\n        User.findOrCreate({ exampleId: profile.id }, function (err, user) {\n          return cb(err, user);\n        });\n      }\n    ));\n  ```\n- **Do** use environment variables to store sensitive information such as secrets. This method keeps credentials out of your codebase and makes them easier to manage securely.\n- **Do** consider implementing a key-management system to securely handle secrets and other sensitive information. This approach provides enhanced security measures for managing and accessing credentials.\n\n## References\n\n- [OWASP hardcoded passwords](https://owasp.org/www-community/vulnerabilities/Use_of_hard-coded_password)\n- [Google Cloud Key Management Service](https://cloud.google.com/kms/docs)\n- [AWS Key Management Service](https://aws.amazon.com/kms/)","documentation_url":"https://docs.bearer.com/reference/rules/javascript_lang_hardcoded_secret","line_number":602,"full_filename":"sources/broken-crystals/src/auth/auth.controller.ts","filename":"src/auth/auth.controller.ts","category_groups":["PII","Personal Data"],"source":{"start":602,"end":602,"column":{"start":7,"end":35}},"sink":{"start":602,"end":602,"column":{"start":7,"end":35},"content":""},"parent_line_number":602,"fingerprint":"10171a9597f7456e91b04287f9d1d0ef_6","old_fingerprint":"3813e36ea46fa91c60dfe286c619da45_7","code_extract":"      secret: 'this is our secret'"},{"cwe_ids":["798"],"id":"javascript_lang_hardcoded_secret","title":"Usage of hard-coded secret","description":"## Description\n\nStoring secrets directly in your code is a security risk. Instead, opt for environment variables or a secret management system to safeguard your secrets.\n\n## Remediations\n\n- **Do not** store plaintext secrets in your code. This exposes sensitive information to unnecessary risk.\n  ```javascript\n    passport.use(new OAuth2Strategy({\n        authorizationURL: 'https://www.example.com/oauth2/authorize',\n        tokenURL: 'https://www.example.com/oauth2/token',\n        clientID: 'my-id-123',\n        clientSecret: 'shh-my-secret',\n        callbackURL: 'http://localhost:3000/auth/example/callback'\n      },\n      function(accessToken, refreshToken, profile, cb) {\n        User.findOrCreate({ exampleId: profile.id }, function (err, user) {\n          return cb(err, user);\n        });\n      }\n    ));\n  ```\n- **Do** use environment variables to store sensitive information such as secrets. This method keeps credentials out of your codebase and makes them easier to manage securely.\n- **Do** consider implementing a key-management system to securely handle secrets and other sensitive information. This approach provides enhanced security measures for managing and accessing credentials.\n\n## References\n\n- [OWASP hardcoded passwords](https://owasp.org/www-community/vulnerabilities/Use_of_hard-coded_password)\n- [Google Cloud Key Management Service](https://cloud.google.com/kms/docs)\n- [AWS Key Management Service](https://aws.amazon.com/kms/)","documentation_url":"https://docs.bearer.com/reference/rules/javascript_lang_hardcoded_secret","line_number":662,"full_filename":"sources/broken-crystals/src/auth/auth.controller.ts","filename":"src/auth/auth.controller.ts","category_groups":["PII","Personal Data"],"source":{"start":662,"end":662,"column":{"start":7,"end":35}},"sink":{"start":662,"end":662,"column":{"start":7,"end":35},"content":""},"parent_line_number":662,"fingerprint":"10171a9597f7456e91b04287f9d1d0ef_7","old_fingerprint":"3813e36ea46fa91c60dfe286c619da45_8","code_extract":"      secret: 'this is our secret'"}],"high":[{"cwe_ids":["79"],"id":"javascript_lang_dangerous_insert_html","title":"Unsanitized user input in dynamic HTML insertion (XSS)","description":"## Description\n\nUnsanitized user input in dynamic HTML insertion can lead to Cross-Site Scripting (XSS) attacks. This vulnerability arises when user-provided data is directly inserted into the DOM without proper sanitization, potentially allowing attackers to execute malicious scripts.\n\n## Remediations\n\n- **Do** use an HTML sanitization library to clean user input before inserting it into the HTML. This step helps prevent XSS attacks by removing or neutralizing any potentially harmful scripts.\n  ```javascript\n  import sanitizeHtml from 'sanitize-html';\n\n  const html = `\u003cstrong\u003e${user.Input}\u003c/strong\u003e`;\n  document.body.innerHTML = sanitizeHtml(html);\n  ```\n\n## References\n\n- [OWASP XSS explained](https://owasp.org/www-community/attacks/xss/)","documentation_url":"https://docs.bearer.com/reference/rules/javascript_lang_dangerous_insert_html","line_number":8,"full_filename":"sources/broken-crystals/client/src/pages/main/Contact.tsx","filename":"client/src/pages/main/Contact.tsx","category_groups":["PII","Personal Data"],"source":{"start":8,"end":10,"column":{"start":7,"end":331}},"sink":{"start":8,"end":10,"column":{"start":7,"end":331},"content":""},"parent_line_number":8,"fingerprint":"ac42a156dd63ce0956644f4dcff72375_0","old_fingerprint":"1771944473a88cbcb0cc7c9adb2d38eb_0","code_extract":"      mapElement.outerHTML = `\u003ciframe class=\"mb-4 mb-lg-0\" title=\"${\n        props.mapTitle || ''\n      }\" src=\"https://www.google.com/maps/embed?pb=!1m14!1m8!1m3!1d12097.433213460943!2d-74.0062269!3d40.7101282!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x0%3A0xb89d1fe6bc499443!2sDowntown+Conference+Center!5e0!3m2!1smk!2sbg!4v1539943755621\" frameborder=\"0\" allowfullscreen=\"\" style=\"border: 0px; width: 100%; height: 384px;\"\u003e\u003c/iframe\u003e`;"},{"cwe_ids":["79"],"id":"javascript_lang_dangerous_insert_html","title":"Unsanitized user input in dynamic HTML insertion (XSS)","description":"## Description\n\nUnsanitized user input in dynamic HTML insertion can lead to Cross-Site Scripting (XSS) attacks. This vulnerability arises when user-provided data is directly inserted into the DOM without proper sanitization, potentially allowing attackers to execute malicious scripts.\n\n## Remediations\n\n- **Do** use an HTML sanitization library to clean user input before inserting it into the HTML. This step helps prevent XSS attacks by removing or neutralizing any potentially harmful scripts.\n  ```javascript\n  import sanitizeHtml from 'sanitize-html';\n\n  const html = `\u003cstrong\u003e${user.Input}\u003c/strong\u003e`;\n  document.body.innerHTML = sanitizeHtml(html);\n  ```\n\n## References\n\n- [OWASP XSS explained](https://owasp.org/www-community/attacks/xss/)","documentation_url":"https://docs.bearer.com/reference/rules/javascript_lang_dangerous_insert_html","line_number":126,"full_filename":"sources/broken-crystals/client/src/pages/marketplace/Marketplace.tsx","filename":"client/src/pages/marketplace/Marketplace.tsx","category_groups":["PII","Personal Data"],"source":{"start":126,"end":128,"column":{"start":7,"end":20}},"sink":{"start":126,"end":128,"column":{"start":7,"end":20},"content":""},"parent_line_number":126,"fingerprint":"6ba640add39db23b07e1c0e5f5c4f18e_0","old_fingerprint":"fc11236d41b768c2312241a9fa140053_1","code_extract":"      videoElement.outerHTML = `\u003ciframe width=\"560\" height=\"315\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\" ${\n        videoSrc \u0026\u0026 'src=\"' + videoSrc\n      }\"\u003e\u003c/iframe\u003e`;"},{"cwe_ids":["73"],"id":"javascript_lang_non_literal_fs_filename","title":"Unsanitized dynamic input in file path","description":"## Description\n\nAllowing unsanitized dynamic input in file paths can lead to unauthorized file and folder access. This vulnerability arises when dynamic data is used within the file system operations, potentially allowing attackers to access unauthorized or hidden files and folders.\n\n## Remediations\n\n- **Do** sanitize all dynamic data and function arguments before using them in file system operations. This step is crucial to prevent unauthorized access.\n- **Do** use a combination of hard-coded string literals and control logic, instead of directly passing dynamic data or function arguments to file system functions. This ensures safety.\n  ```javascript\n  function write(filename) {\n    switch(filename) {\n      case \"hello.txt\":\n        fs.writeCreateFile(\"hello.txt\");\n        break;\n      // Add more cases as necessary\n    }\n  }\n  ```\n\n## References\n\n- [OWASP path traversal](https://owasp.org/www-community/attacks/Path_Traversal)","documentation_url":"https://docs.bearer.com/reference/rules/javascript_lang_non_literal_fs_filename","line_number":43,"full_filename":"sources/broken-crystals/src/auth/auth.service.ts","filename":"src/auth/auth.service.ts","category_groups":["PII","Personal Data"],"source":{"start":43,"end":48,"column":{"start":24,"end":6}},"sink":{"start":43,"end":48,"column":{"start":24,"end":6},"content":""},"parent_line_number":43,"fingerprint":"da2649b30db6fceff12b334c205674a4_0","old_fingerprint":"91a2d61bce35da3957380a680a1c87d9_2","code_extract":"    const privateKey = fs.readFileSync(\n      this.configService.get\u003cstring\u003e(\n        AuthModuleConfigProperties.ENV_JWT_PRIVATE_KEY_LOCATION\n      ),\n      'utf8'\n    );"},{"cwe_ids":["73"],"id":"javascript_lang_non_literal_fs_filename","title":"Unsanitized dynamic input in file path","description":"## Description\n\nAllowing unsanitized dynamic input in file paths can lead to unauthorized file and folder access. This vulnerability arises when dynamic data is used within the file system operations, potentially allowing attackers to access unauthorized or hidden files and folders.\n\n## Remediations\n\n- **Do** sanitize all dynamic data and function arguments before using them in file system operations. This step is crucial to prevent unauthorized access.\n- **Do** use a combination of hard-coded string literals and control logic, instead of directly passing dynamic data or function arguments to file system functions. This ensures safety.\n  ```javascript\n  function write(filename) {\n    switch(filename) {\n      case \"hello.txt\":\n        fs.writeCreateFile(\"hello.txt\");\n        break;\n      // Add more cases as necessary\n    }\n  }\n  ```\n\n## References\n\n- [OWASP path traversal](https://owasp.org/www-community/attacks/Path_Traversal)","documentation_url":"https://docs.bearer.com/reference/rules/javascript_lang_non_literal_fs_filename","line_number":49,"full_filename":"sources/broken-crystals/src/auth/auth.service.ts","filename":"src/auth/auth.service.ts","category_groups":["PII","Personal Data"],"source":{"start":49,"end":54,"column":{"start":23,"end":6}},"sink":{"start":49,"end":54,"column":{"start":23,"end":6},"content":""},"parent_line_number":49,"fingerprint":"da2649b30db6fceff12b334c205674a4_1","old_fingerprint":"91a2d61bce35da3957380a680a1c87d9_3","code_extract":"    const publicKey = fs.readFileSync(\n      this.configService.get\u003cstring\u003e(\n        AuthModuleConfigProperties.ENV_JWT_PUBLIC_KEY_LOCATION\n      ),\n      'utf8'\n    );"},{"cwe_ids":["73"],"id":"javascript_lang_non_literal_fs_filename","title":"Unsanitized dynamic input in file path","description":"## Description\n\nAllowing unsanitized dynamic input in file paths can lead to unauthorized file and folder access. This vulnerability arises when dynamic data is used within the file system operations, potentially allowing attackers to access unauthorized or hidden files and folders.\n\n## Remediations\n\n- **Do** sanitize all dynamic data and function arguments before using them in file system operations. This step is crucial to prevent unauthorized access.\n- **Do** use a combination of hard-coded string literals and control logic, instead of directly passing dynamic data or function arguments to file system functions. This ensures safety.\n  ```javascript\n  function write(filename) {\n    switch(filename) {\n      case \"hello.txt\":\n        fs.writeCreateFile(\"hello.txt\");\n        break;\n      // Add more cases as necessary\n    }\n  }\n  ```\n\n## References\n\n- [OWASP path traversal](https://owasp.org/www-community/attacks/Path_Traversal)","documentation_url":"https://docs.bearer.com/reference/rules/javascript_lang_non_literal_fs_filename","line_number":55,"full_filename":"sources/broken-crystals/src/auth/auth.service.ts","filename":"src/auth/auth.service.ts","category_groups":["PII","Personal Data"],"source":{"start":55,"end":60,"column":{"start":27,"end":6}},"sink":{"start":55,"end":60,"column":{"start":27,"end":6},"content":""},"parent_line_number":55,"fingerprint":"da2649b30db6fceff12b334c205674a4_2","old_fingerprint":"91a2d61bce35da3957380a680a1c87d9_4","code_extract":"    const jwkPrivateKey = fs.readFileSync(\n      this.configService.get\u003cstring\u003e(\n        AuthModuleConfigProperties.ENV_JWK_PRIVATE_KEY_LOCATION\n      ),\n      'utf8'\n    );"},{"cwe_ids":["73"],"id":"javascript_lang_non_literal_fs_filename","title":"Unsanitized dynamic input in file path","description":"## Description\n\nAllowing unsanitized dynamic input in file paths can lead to unauthorized file and folder access. This vulnerability arises when dynamic data is used within the file system operations, potentially allowing attackers to access unauthorized or hidden files and folders.\n\n## Remediations\n\n- **Do** sanitize all dynamic data and function arguments before using them in file system operations. This step is crucial to prevent unauthorized access.\n- **Do** use a combination of hard-coded string literals and control logic, instead of directly passing dynamic data or function arguments to file system functions. This ensures safety.\n  ```javascript\n  function write(filename) {\n    switch(filename) {\n      case \"hello.txt\":\n        fs.writeCreateFile(\"hello.txt\");\n        break;\n      // Add more cases as necessary\n    }\n  }\n  ```\n\n## References\n\n- [OWASP path traversal](https://owasp.org/www-community/attacks/Path_Traversal)","documentation_url":"https://docs.bearer.com/reference/rules/javascript_lang_non_literal_fs_filename","line_number":62,"full_filename":"sources/broken-crystals/src/auth/auth.service.ts","filename":"src/auth/auth.service.ts","category_groups":["PII","Personal Data"],"source":{"start":62,"end":67,"column":{"start":7,"end":8}},"sink":{"start":62,"end":67,"column":{"start":7,"end":8},"content":""},"parent_line_number":62,"fingerprint":"da2649b30db6fceff12b334c205674a4_3","old_fingerprint":"91a2d61bce35da3957380a680a1c87d9_5","code_extract":"      fs.readFileSync(\n        this.configService.get\u003cstring\u003e(\n          AuthModuleConfigProperties.ENV_JWK_PUBLIC_JSON\n        ),\n        'utf8'\n      )"},{"cwe_ids":["73"],"id":"javascript_lang_non_literal_fs_filename","title":"Unsanitized dynamic input in file path","description":"## Description\n\nAllowing unsanitized dynamic input in file paths can lead to unauthorized file and folder access. This vulnerability arises when dynamic data is used within the file system operations, potentially allowing attackers to access unauthorized or hidden files and folders.\n\n## Remediations\n\n- **Do** sanitize all dynamic data and function arguments before using them in file system operations. This step is crucial to prevent unauthorized access.\n- **Do** use a combination of hard-coded string literals and control logic, instead of directly passing dynamic data or function arguments to file system functions. This ensures safety.\n  ```javascript\n  function write(filename) {\n    switch(filename) {\n      case \"hello.txt\":\n        fs.writeCreateFile(\"hello.txt\");\n        break;\n      // Add more cases as necessary\n    }\n  }\n  ```\n\n## References\n\n- [OWASP path traversal](https://owasp.org/www-community/attacks/Path_Traversal)","documentation_url":"https://docs.bearer.com/reference/rules/javascript_lang_non_literal_fs_filename","line_number":19,"full_filename":"sources/broken-crystals/src/file/file.service.ts","filename":"src/file/file.service.ts","category_groups":["PII","Personal Data"],"source":{"start":19,"end":19,"column":{"start":14,"end":39}},"sink":{"start":19,"end":19,"column":{"start":14,"end":39},"content":""},"parent_line_number":19,"fingerprint":"83411f9660e931017dcd5c24197615bb_0","old_fingerprint":"d3bdb0e8d300fed4e13d1a036a98f849_0","code_extract":"      return fs.createReadStream(file);"},{"cwe_ids":["73"],"id":"javascript_lang_non_literal_fs_filename","title":"Unsanitized dynamic input in file path","description":"## Description\n\nAllowing unsanitized dynamic input in file paths can lead to unauthorized file and folder access. This vulnerability arises when dynamic data is used within the file system operations, potentially allowing attackers to access unauthorized or hidden files and folders.\n\n## Remediations\n\n- **Do** sanitize all dynamic data and function arguments before using them in file system operations. This step is crucial to prevent unauthorized access.\n- **Do** use a combination of hard-coded string literals and control logic, instead of directly passing dynamic data or function arguments to file system functions. This ensures safety.\n  ```javascript\n  function write(filename) {\n    switch(filename) {\n      case \"hello.txt\":\n        fs.writeCreateFile(\"hello.txt\");\n        break;\n      // Add more cases as necessary\n    }\n  }\n  ```\n\n## References\n\n- [OWASP path traversal](https://owasp.org/www-community/attacks/Path_Traversal)","documentation_url":"https://docs.bearer.com/reference/rules/javascript_lang_non_literal_fs_filename","line_number":33,"full_filename":"sources/broken-crystals/src/file/file.service.ts","filename":"src/file/file.service.ts","category_groups":["PII","Personal Data"],"source":{"start":33,"end":33,"column":{"start":14,"end":39}},"sink":{"start":33,"end":33,"column":{"start":14,"end":39},"content":""},"parent_line_number":33,"fingerprint":"83411f9660e931017dcd5c24197615bb_1","old_fingerprint":"d3bdb0e8d300fed4e13d1a036a98f849_1","code_extract":"      return fs.createReadStream(file);"},{"cwe_ids":["22"],"id":"javascript_lang_path_traversal","title":"Unsanitized dynamic input in file path","description":"## Description\n\nUsing unsanitized dynamic input to determine file paths can allow attackers to gain access to files and folders outside of the intended scope. This vulnerability occurs when input provided by users is directly used to access the filesystem without proper validation or sanitization.\n\n## Remediations\n\n- **Do not** directly use user input to construct file paths. This can lead to unauthorized file access.\n- **Do** sanitize user input used in file paths. Replace patterns that can navigate out of intended directories, such as `..\\..`, to prevent path traversal attacks.\n  ```javascript\n  var folder = target.replace(/^(\\.\\.(\\/|\\\\|$))+/, '');\n  ```\n- **Do** check for and remove any instances of the NULL byte (\"%00\") in user input to guard against poison NULL byte attacks.\n  ```javascript\n  if (target.indexOf('\\0') !== -1) {\n    // Handle or reject the input\n  }\n  ```\n- **Do** use path concatenation methods provided by your programming environment to securely combine user input with your base directory path. This ensures the final path starts within the intended scope.\n  ```javascript\n  const path = require(\"path\");\n  var pathname = path.join(\"/public/\", folder);\n  if (pathname.indexOf(\"/public/\") !== 0) {\n    // Handle or reject the input\n  }\n  ```\n\n## References\n\n- [OWASP Path Traversal](https://owasp.org/www-community/attacks/Path_Traversal)","documentation_url":"https://docs.bearer.com/reference/rules/javascript_lang_path_traversal","line_number":29,"full_filename":"sources/broken-crystals/src/file/file.service.ts","filename":"src/file/file.service.ts","category_groups":["PII","Personal Data"],"source":{"start":29,"end":29,"column":{"start":14,"end":47}},"sink":{"start":29,"end":29,"column":{"start":14,"end":47},"content":""},"parent_line_number":29,"fingerprint":"5df09410d3f7b64fbb2bdeb8546f7862_0","old_fingerprint":"005f361f05f878d1a1d1fae907a6c44c_0","code_extract":"      file = path.resolve(process.cwd(), file);"},{"cwe_ids":["22"],"id":"javascript_lang_path_traversal","title":"Unsanitized dynamic input in file path","description":"## Description\n\nUsing unsanitized dynamic input to determine file paths can allow attackers to gain access to files and folders outside of the intended scope. This vulnerability occurs when input provided by users is directly used to access the filesystem without proper validation or sanitization.\n\n## Remediations\n\n- **Do not** directly use user input to construct file paths. This can lead to unauthorized file access.\n- **Do** sanitize user input used in file paths. Replace patterns that can navigate out of intended directories, such as `..\\..`, to prevent path traversal attacks.\n  ```javascript\n  var folder = target.replace(/^(\\.\\.(\\/|\\\\|$))+/, '');\n  ```\n- **Do** check for and remove any instances of the NULL byte (\"%00\") in user input to guard against poison NULL byte attacks.\n  ```javascript\n  if (target.indexOf('\\0') !== -1) {\n    // Handle or reject the input\n  }\n  ```\n- **Do** use path concatenation methods provided by your programming environment to securely combine user input with your base directory path. This ensures the final path starts within the intended scope.\n  ```javascript\n  const path = require(\"path\");\n  var pathname = path.join(\"/public/\", folder);\n  if (pathname.indexOf(\"/public/\") !== 0) {\n    // Handle or reject the input\n  }\n  ```\n\n## References\n\n- [OWASP Path Traversal](https://owasp.org/www-community/attacks/Path_Traversal)","documentation_url":"https://docs.bearer.com/reference/rules/javascript_lang_path_traversal","line_number":43,"full_filename":"sources/broken-crystals/src/file/file.service.ts","filename":"src/file/file.service.ts","category_groups":["PII","Personal Data"],"source":{"start":43,"end":43,"column":{"start":14,"end":47}},"sink":{"start":43,"end":43,"column":{"start":14,"end":47},"content":""},"parent_line_number":43,"fingerprint":"5df09410d3f7b64fbb2bdeb8546f7862_1","old_fingerprint":"005f361f05f878d1a1d1fae907a6c44c_1","code_extract":"      file = path.resolve(process.cwd(), file);"},{"cwe_ids":["22"],"id":"javascript_lang_path_traversal","title":"Unsanitized dynamic input in file path","description":"## Description\n\nUsing unsanitized dynamic input to determine file paths can allow attackers to gain access to files and folders outside of the intended scope. This vulnerability occurs when input provided by users is directly used to access the filesystem without proper validation or sanitization.\n\n## Remediations\n\n- **Do not** directly use user input to construct file paths. This can lead to unauthorized file access.\n- **Do** sanitize user input used in file paths. Replace patterns that can navigate out of intended directories, such as `..\\..`, to prevent path traversal attacks.\n  ```javascript\n  var folder = target.replace(/^(\\.\\.(\\/|\\\\|$))+/, '');\n  ```\n- **Do** check for and remove any instances of the NULL byte (\"%00\") in user input to guard against poison NULL byte attacks.\n  ```javascript\n  if (target.indexOf('\\0') !== -1) {\n    // Handle or reject the input\n  }\n  ```\n- **Do** use path concatenation methods provided by your programming environment to securely combine user input with your base directory path. This ensures the final path starts within the intended scope.\n  ```javascript\n  const path = require(\"path\");\n  var pathname = path.join(\"/public/\", folder);\n  if (pathname.indexOf(\"/public/\") !== 0) {\n    // Handle or reject the input\n  }\n  ```\n\n## References\n\n- [OWASP Path Traversal](https://owasp.org/www-community/attacks/Path_Traversal)","documentation_url":"https://docs.bearer.com/reference/rules/javascript_lang_path_traversal","line_number":51,"full_filename":"sources/broken-crystals/src/file/hidden-upload.controller.ts","filename":"src/file/hidden-upload.controller.ts","category_groups":["PII","Personal Data"],"source":{"start":51,"end":51,"column":{"start":25,"end":62}},"sink":{"start":51,"end":51,"column":{"start":25,"end":62},"content":""},"parent_line_number":51,"fingerprint":"e3e5c711d5dbe1823a0306436adf27b9_0","old_fingerprint":"61f57d24599ed7ca917468ed1c8bb346_2","code_extract":"    const destination = path.join(this.uploadDir, storedName);"},{"cwe_ids":["312"],"id":"javascript_lang_session","title":"Leakage of sensitive data in local storage","description":"## Description\n\nStoring sensitive data in `localStorage` poses a security risk. This vulnerability occurs when sensitive information is saved in the browser's local storage, making it susceptible to unauthorized access.\n\n## Remediations\n\n- **Do not** store sensitive data in `localStorage`. This method exposes sensitive information to potential security threats.\n  ```javascript\n  localStorage.setItem('user', email); // unsafe\n  ```\n- **Do** use server-based session storage solutions to keep session data secure. This approach minimizes the risk of sensitive data exposure.\n- **Do** store only non-sensitive data in `localStorage`, such as a unique identifier, to reduce security risks.\n  ```javascript\n  localStorage.setItem('user', user.uuid);\n  ```\n\n## References\n\n- [OWASP sensitive data exposure](https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure)","documentation_url":"https://docs.bearer.com/reference/rules/javascript_lang_session","line_number":64,"full_filename":"sources/broken-crystals/client/src/pages/auth/LoginNew/PasswordCheck.tsx","filename":"client/src/pages/auth/LoginNew/PasswordCheck.tsx","data_type":{"category_uuid":"14124881-6b92-4fc5-8005-ea7c1c09592e","name":"Firstname"},"category_groups":["PII","Personal Data"],"source":{"start":66,"end":66,"column":{"start":16,"end":34}},"sink":{"start":64,"end":67,"column":{"start":11,"end":12},"content":""},"parent_line_number":64,"fingerprint":"bf2f24968e0684f14d904576f37aadae_0","old_fingerprint":"a737122abf2bd0a7b3b4a8f04c12f384_2","code_extract":"          localStorage.setItem(\n            'userName',\n            `${userData.firstName} ${userData.lastName}`\n          );"},{"cwe_ids":["312"],"id":"javascript_lang_session","title":"Leakage of sensitive data in local storage","description":"## Description\n\nStoring sensitive data in `localStorage` poses a security risk. This vulnerability occurs when sensitive information is saved in the browser's local storage, making it susceptible to unauthorized access.\n\n## Remediations\n\n- **Do not** store sensitive data in `localStorage`. This method exposes sensitive information to potential security threats.\n  ```javascript\n  localStorage.setItem('user', email); // unsafe\n  ```\n- **Do** use server-based session storage solutions to keep session data secure. This approach minimizes the risk of sensitive data exposure.\n- **Do** store only non-sensitive data in `localStorage`, such as a unique identifier, to reduce security risks.\n  ```javascript\n  localStorage.setItem('user', user.uuid);\n  ```\n\n## References\n\n- [OWASP sensitive data exposure](https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure)","documentation_url":"https://docs.bearer.com/reference/rules/javascript_lang_session","line_number":47,"full_filename":"sources/broken-crystals/client/src/pages/main/Userprofile.tsx","filename":"client/src/pages/main/Userprofile.tsx","data_type":{"category_uuid":"14124881-6b92-4fc5-8005-ea7c1c09592e","name":"Firstname"},"category_groups":["PII","Personal Data"],"source":{"start":47,"end":47,"column":{"start":45,"end":59}},"sink":{"start":47,"end":47,"column":{"start":9,"end":79},"content":""},"parent_line_number":47,"fingerprint":"a423e90a3cf32f0c96b4cbf2033472b7_0","old_fingerprint":"3588f44b93222efab0c96ad5e3ec068c_0","code_extract":"        localStorage.setItem('userName', `${user.firstName} ${user.lastName}`);"},{"cwe_ids":["79"],"id":"javascript_react_dangerously_set_inner_html","title":"Unsanitized user input in React inner HTML method (XSS)","description":"## Description\n\nUsing React's dangerouslySetInnerHTML with unsanitized data can introduce Cross-Site Scripting (XSS) vulnerabilities. This occurs when external input is embedded directly into the HTML without proper sanitization, allowing attackers to inject malicious scripts.\n\n## Remediations\n\n- **Do** sanitize data before using it with dangerouslySetInnerHTML. This step is crucial to prevent XSS attacks by ensuring that the input does not contain harmful scripts.\n```javascript\n\u003cdiv dangerouslySetInnerHTML={{__html: sanitize(data)}} /\u003e\n```\n\n## References\n\n- [OWASP Cross-Site Scripting (XSS) Cheatsheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html)","documentation_url":"https://docs.bearer.com/reference/rules/javascript_react_dangerously_set_inner_html","line_number":7,"full_filename":"sources/broken-crystals/client/src/pages/chat/ChatWidget.tsx","filename":"client/src/pages/chat/ChatWidget.tsx","category_groups":["PII","Personal Data"],"source":{"start":7,"end":7,"column":{"start":40,"end":56}},"sink":{"start":7,"end":7,"column":{"start":40,"end":56},"content":""},"parent_line_number":7,"fingerprint":"3ec087ff32a64263281b288ab52afe24_0","old_fingerprint":"0d8fbc9767232dcf8eaab8402741a48a_0","code_extract":"  return \u003cdiv dangerouslySetInnerHTML={{ __html: html }} /\u003e;"},{"cwe_ids":["79"],"id":"javascript_react_dangerously_set_inner_html","title":"Unsanitized user input in React inner HTML method (XSS)","description":"## Description\n\nUsing React's dangerouslySetInnerHTML with unsanitized data can introduce Cross-Site Scripting (XSS) vulnerabilities. This occurs when external input is embedded directly into the HTML without proper sanitization, allowing attackers to inject malicious scripts.\n\n## Remediations\n\n- **Do** sanitize data before using it with dangerouslySetInnerHTML. This step is crucial to prevent XSS attacks by ensuring that the input does not contain harmful scripts.\n```javascript\n\u003cdiv dangerouslySetInnerHTML={{__html: sanitize(data)}} /\u003e\n```\n\n## References\n\n- [OWASP Cross-Site Scripting (XSS) Cheatsheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html)","documentation_url":"https://docs.bearer.com/reference/rules/javascript_react_dangerously_set_inner_html","line_number":132,"full_filename":"sources/broken-crystals/client/src/pages/hidden/HiddenUpload.tsx","filename":"client/src/pages/hidden/HiddenUpload.tsx","category_groups":["PII","Personal Data"],"source":{"start":132,"end":132,"column":{"start":42,"end":62}},"sink":{"start":132,"end":132,"column":{"start":42,"end":62},"content":""},"parent_line_number":132,"fingerprint":"1a2e61f6bd1dc7d6fa5be4b41b15e5e6_0","old_fingerprint":"5a93bbdea744cd9a9d29d4268b11d51a_1","code_extract":"                dangerouslySetInnerHTML={{ __html: fileName }}"},{"cwe_ids":["79"],"id":"javascript_react_dangerously_set_inner_html","title":"Unsanitized user input in React inner HTML method (XSS)","description":"## Description\n\nUsing React's dangerouslySetInnerHTML with unsanitized data can introduce Cross-Site Scripting (XSS) vulnerabilities. This occurs when external input is embedded directly into the HTML without proper sanitization, allowing attackers to inject malicious scripts.\n\n## Remediations\n\n- **Do** sanitize data before using it with dangerouslySetInnerHTML. This step is crucial to prevent XSS attacks by ensuring that the input does not contain harmful scripts.\n```javascript\n\u003cdiv dangerouslySetInnerHTML={{__html: sanitize(data)}} /\u003e\n```\n\n## References\n\n- [OWASP Cross-Site Scripting (XSS) Cheatsheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html)","documentation_url":"https://docs.bearer.com/reference/rules/javascript_react_dangerously_set_inner_html","line_number":172,"full_filename":"sources/broken-crystals/client/src/pages/hidden/HiddenUpload.tsx","filename":"client/src/pages/hidden/HiddenUpload.tsx","category_groups":["PII","Personal Data"],"source":{"start":172,"end":172,"column":{"start":50,"end":77}},"sink":{"start":172,"end":172,"column":{"start":50,"end":77},"content":""},"parent_line_number":172,"fingerprint":"1a2e61f6bd1dc7d6fa5be4b41b15e5e6_1","old_fingerprint":"5a93bbdea744cd9a9d29d4268b11d51a_2","code_extract":"                        dangerouslySetInnerHTML={{ __html: preview.content }}"}],"low":[{"cwe_ids":["532"],"id":"javascript_lang_logger_leak","title":"Leakage of information in logger message","description":"## Description\n\nInformation leakage through logger messages can compromise sensitive data. This vulnerability arises when dynamic data or variables, which may contain sensitive information, are included in log messages.\n\n## Remediations\n\n- **Do not** include sensitive data directly in logger messages. This can lead to the exposure of such data in log files, which might be accessible to unauthorized individuals.\n  ```javascript\n  logger.info(`Results: ${data}`) // unsafe\n  ```\n- **Do** use logging levels appropriately to control the verbosity of log output and minimize the risk of leaking sensitive information in production environments.","documentation_url":"https://docs.bearer.com/reference/rules/javascript_lang_logger_leak","line_number":15,"full_filename":"sources/broken-crystals/client/src/pages/main/Header/Header.tsx","filename":"client/src/pages/main/Header/Header.tsx","category_groups":["PII","Personal Data"],"source":{"start":15,"end":15,"column":{"start":35,"end":59}},"sink":{"start":15,"end":15,"column":{"start":35,"end":59},"content":""},"parent_line_number":15,"fingerprint":"b8b9623f2f73728f53b121fd9fa28379_0","old_fingerprint":"3afe134ee36df6c63b1f51b377022dd2_0","code_extract":"    postMetadata().then((data) =\u003e console.log('xml', data));"},{"cwe_ids":["532"],"id":"javascript_lang_logger_leak","title":"Leakage of information in logger message","description":"## Description\n\nInformation leakage through logger messages can compromise sensitive data. This vulnerability arises when dynamic data or variables, which may contain sensitive information, are included in log messages.\n\n## Remediations\n\n- **Do not** include sensitive data directly in logger messages. This can lead to the exposure of such data in log files, which might be accessible to unauthorized individuals.\n  ```javascript\n  logger.info(`Results: ${data}`) // unsafe\n  ```\n- **Do** use logging levels appropriately to control the verbosity of log output and minimize the risk of leaking sensitive information in production environments.","documentation_url":"https://docs.bearer.com/reference/rules/javascript_lang_logger_leak","line_number":16,"full_filename":"sources/broken-crystals/client/src/pages/main/Header/Header.tsx","filename":"client/src/pages/main/Header/Header.tsx","category_groups":["PII","Personal Data"],"source":{"start":16,"end":16,"column":{"start":35,"end":61}},"sink":{"start":16,"end":16,"column":{"start":35,"end":61},"content":""},"parent_line_number":16,"fingerprint":"b8b9623f2f73728f53b121fd9fa28379_1","old_fingerprint":"3afe134ee36df6c63b1f51b377022dd2_1","code_extract":"    getSpawnData().then((data) =\u003e console.log('spawn', data));"},{"cwe_ids":["532"],"id":"javascript_lang_logger_leak","title":"Leakage of information in logger message","description":"## Description\n\nInformation leakage through logger messages can compromise sensitive data. This vulnerability arises when dynamic data or variables, which may contain sensitive information, are included in log messages.\n\n## Remediations\n\n- **Do not** include sensitive data directly in logger messages. This can lead to the exposure of such data in log files, which might be accessible to unauthorized individuals.\n  ```javascript\n  logger.info(`Results: ${data}`) // unsafe\n  ```\n- **Do** use logging levels appropriately to control the verbosity of log output and minimize the risk of leaking sensitive information in production environments.","documentation_url":"https://docs.bearer.com/reference/rules/javascript_lang_logger_leak","line_number":17,"full_filename":"sources/broken-crystals/client/src/pages/main/Header/Header.tsx","filename":"client/src/pages/main/Header/Header.tsx","category_groups":["PII","Personal Data"],"source":{"start":17,"end":17,"column":{"start":39,"end":70}},"sink":{"start":17,"end":17,"column":{"start":39,"end":70},"content":""},"parent_line_number":17,"fingerprint":"b8b9623f2f73728f53b121fd9fa28379_2","old_fingerprint":"3afe134ee36df6c63b1f51b377022dd2_2","code_extract":"    getSpawnDataGrpc().then((data) =\u003e console.log('spawn grpc', data));"},{"cwe_ids":["532"],"id":"javascript_lang_logger_leak","title":"Leakage of information in logger message","description":"## Description\n\nInformation leakage through logger messages can compromise sensitive data. This vulnerability arises when dynamic data or variables, which may contain sensitive information, are included in log messages.\n\n## Remediations\n\n- **Do not** include sensitive data directly in logger messages. This can lead to the exposure of such data in log files, which might be accessible to unauthorized individuals.\n  ```javascript\n  logger.info(`Results: ${data}`) // unsafe\n  ```\n- **Do** use logging levels appropriately to control the verbosity of log output and minimize the risk of leaking sensitive information in production environments.","documentation_url":"https://docs.bearer.com/reference/rules/javascript_lang_logger_leak","line_number":21,"full_filename":"sources/broken-crystals/client/src/pages/main/Header/Header.tsx","filename":"client/src/pages/main/Header/Header.tsx","category_groups":["PII","Personal Data"],"source":{"start":21,"end":21,"column":{"start":26,"end":50}},"sink":{"start":21,"end":21,"column":{"start":26,"end":50},"content":""},"parent_line_number":21,"fingerprint":"b8b9623f2f73728f53b121fd9fa28379_3","old_fingerprint":"3afe134ee36df6c63b1f51b377022dd2_3","code_extract":"    goTo(url).then(() =\u003e console.log('goto', url));"},{"cwe_ids":["532"],"id":"javascript_lang_logger_leak","title":"Leakage of information in logger message","description":"## Description\n\nInformation leakage through logger messages can compromise sensitive data. This vulnerability arises when dynamic data or variables, which may contain sensitive information, are included in log messages.\n\n## Remediations\n\n- **Do not** include sensitive data directly in logger messages. This can lead to the exposure of such data in log files, which might be accessible to unauthorized individuals.\n  ```javascript\n  logger.info(`Results: ${data}`) // unsafe\n  ```\n- **Do** use logging levels appropriately to control the verbosity of log output and minimize the risk of leaking sensitive information in production environments.","documentation_url":"https://docs.bearer.com/reference/rules/javascript_lang_logger_leak","line_number":38,"full_filename":"sources/broken-crystals/client/src/pages/marketplace/ProductView.tsx","filename":"client/src/pages/marketplace/ProductView.tsx","category_groups":["PII","Personal Data"],"source":{"start":38,"end":38,"column":{"start":13,"end":64}},"sink":{"start":38,"end":38,"column":{"start":13,"end":64},"content":""},"parent_line_number":38,"fingerprint":"8bedd19ed949ad79449e1c406cb5409c_0","old_fingerprint":"85179facce56c357db98f0491e5222e2_4","code_extract":"            console.log('Product clicked:', props.product.name);"},{"cwe_ids":["532"],"id":"javascript_lang_logger_leak","title":"Leakage of information in logger message","description":"## Description\n\nInformation leakage through logger messages can compromise sensitive data. This vulnerability arises when dynamic data or variables, which may contain sensitive information, are included in log messages.\n\n## Remediations\n\n- **Do not** include sensitive data directly in logger messages. This can lead to the exposure of such data in log files, which might be accessible to unauthorized individuals.\n  ```javascript\n  logger.info(`Results: ${data}`) // unsafe\n  ```\n- **Do** use logging levels appropriately to control the verbosity of log output and minimize the risk of leaking sensitive information in production environments.","documentation_url":"https://docs.bearer.com/reference/rules/javascript_lang_logger_leak","line_number":270,"full_filename":"sources/broken-crystals/src/main.ts","filename":"src/main.ts","category_groups":["PII","Personal Data"],"source":{"start":270,"end":270,"column":{"start":3,"end":51}},"sink":{"start":270,"end":270,"column":{"start":3,"end":51},"content":""},"parent_line_number":270,"fingerprint":"f7de0ba9075331ed71a0078fa22da0ed_0","old_fingerprint":"bfc5903efb5a1519a00515395f395311_5","code_extract":"  console.log(`Primary ${process.pid} is running`);"},{"cwe_ids":["532"],"id":"javascript_lang_logger_leak","title":"Leakage of information in logger message","description":"## Description\n\nInformation leakage through logger messages can compromise sensitive data. This vulnerability arises when dynamic data or variables, which may contain sensitive information, are included in log messages.\n\n## Remediations\n\n- **Do not** include sensitive data directly in logger messages. This can lead to the exposure of such data in log files, which might be accessible to unauthorized individuals.\n  ```javascript\n  logger.info(`Results: ${data}`) // unsafe\n  ```\n- **Do** use logging levels appropriately to control the verbosity of log output and minimize the risk of leaking sensitive information in production environments.","documentation_url":"https://docs.bearer.com/reference/rules/javascript_lang_logger_leak","line_number":278,"full_filename":"sources/broken-crystals/src/main.ts","filename":"src/main.ts","category_groups":["PII","Personal Data"],"source":{"start":278,"end":280,"column":{"start":5,"end":6}},"sink":{"start":278,"end":280,"column":{"start":5,"end":6},"content":""},"parent_line_number":278,"fingerprint":"f7de0ba9075331ed71a0078fa22da0ed_1","old_fingerprint":"bfc5903efb5a1519a00515395f395311_6","code_extract":"    console.log(\n      `Worker ${worker.process.pid} died with code ${code} and signal ${signal}`\n    );"},{"cwe_ids":["532"],"id":"javascript_lang_logger_leak","title":"Leakage of information in logger message","description":"## Description\n\nInformation leakage through logger messages can compromise sensitive data. This vulnerability arises when dynamic data or variables, which may contain sensitive information, are included in log messages.\n\n## Remediations\n\n- **Do not** include sensitive data directly in logger messages. This can lead to the exposure of such data in log files, which might be accessible to unauthorized individuals.\n  ```javascript\n  logger.info(`Results: ${data}`) // unsafe\n  ```\n- **Do** use logging levels appropriately to control the verbosity of log output and minimize the risk of leaking sensitive information in production environments.","documentation_url":"https://docs.bearer.com/reference/rules/javascript_lang_logger_leak","line_number":286,"full_filename":"sources/broken-crystals/src/main.ts","filename":"src/main.ts","category_groups":["PII","Personal Data"],"source":{"start":286,"end":286,"column":{"start":3,"end":47}},"sink":{"start":286,"end":286,"column":{"start":3,"end":47},"content":""},"parent_line_number":286,"fingerprint":"f7de0ba9075331ed71a0078fa22da0ed_2","old_fingerprint":"bfc5903efb5a1519a00515395f395311_7","code_extract":"  console.log(`Worker ${process.pid} started`);"}],"medium":[{"cwe_ids":["1004"],"id":"javascript_express_cookie_missing_http_only","title":"Missing HTTP Only option in cookie configuration","description":"## Description\n\nYour cookies are at risk if the HTTP Only option is not configured. This setting prevents client-side JavaScript, such as the code that reads \"document.cookie\" values, from accessing the cookie's value. Enabling this option is crucial for websites prone to Cross-Site Scripting (XSS) attacks, because it prevents malicious scripts from obtaining the cookie's data.\n\n## Remediations\n\n- **Do** set the `HttpOnly` attribute to `true` in your cookie configuration. This action ensures that cookies are shielded from unauthorized client-side access.\n  ```javascript\n  cookie({ httpOnly: true });\n  ```\n\n## References\n\n- [Express Security Best Practices](https://expressjs.com/en/advanced/best-practice-security.html#use-cookies-securely)","documentation_url":"https://docs.bearer.com/reference/rules/javascript_express_cookie_missing_http_only","line_number":191,"full_filename":"sources/broken-crystals/src/main.ts","filename":"src/main.ts","category_groups":["PII","Personal Data"],"source":{"start":191,"end":198,"column":{"start":34,"end":4}},"sink":{"start":191,"end":198,"column":{"start":34,"end":4},"content":""},"parent_line_number":191,"fingerprint":"95a356b2b3ba584cef6582f9cc23fc62_0","old_fingerprint":"79139fe83d05daa49f7822c535783316_0","code_extract":"  await server.register(session, {\n    secret: randomBytes(32).toString('hex').slice(0, 32),\n    cookieName: 'connect.sid',\n    ...omitted (buffer value 3)\n      httpOnly: false\n    }\n  });"},{"cwe_ids":["693"],"id":"javascript_express_default_cookie_config","title":"Usage of default cookie configuration","description":"## Description\n\nUsing default cookie configurations can expose your application to security risks. This vulnerability arises when cookies are set with their default values, making them predictable and easier to exploit.\n\n## Remediations\n\n- **Do not** rely on default cookie names.\n- **Do** use generic, non-descriptive names for session cookies. This makes it harder for attackers to identify and exploit the session management mechanism of your application.\n- **Do** always specify a `maxAge` or `expires` value to control cookie lifetime.\n\n## References\n\n- [Express Security Best Practices](https://expressjs.com/en/advanced/best-practice-security.html#use-cookies-securely)","documentation_url":"https://docs.bearer.com/reference/rules/javascript_express_default_cookie_config","line_number":194,"full_filename":"sources/broken-crystals/src/main.ts","filename":"src/main.ts","category_groups":["PII","Personal Data"],"source":{"start":194,"end":197,"column":{"start":13,"end":6}},"sink":{"start":194,"end":197,"column":{"start":13,"end":6},"content":""},"parent_line_number":194,"fingerprint":"d9a200c2282a9d4b091410ddc80ee71e_0","old_fingerprint":"eb48a538199a2ee906cc9a583f5f9804_0","code_extract":"    cookie: {\n      secure: false,\n      httpOnly: false\n    }"},{"cwe_ids":["614"],"id":"javascript_express_insecure_cookie","title":"Missing Secure option in cookie configuration","description":"## Description\n\nWhen a cookie lacks the Secure attribute, it can be transmitted over an unencrypted connection, making it vulnerable to interception by unauthorized parties. Enabling the Secure option ensures that cookies are only sent over HTTPS, enhancing the security of data in transit.\n\n## Remediations\n\n- **Do** set the `secure` attribute of cookies to `true`. This action mandates that cookies are sent only over HTTPS, safeguarding them from potential eavesdropping.\n  ```javascript\n  cookie({ secure: true });\n  ```\n\n## References\n\n- [Express Security Best Practices](https://expressjs.com/en/advanced/best-practice-security.html#use-cookies-securely)","documentation_url":"https://docs.bearer.com/reference/rules/javascript_express_insecure_cookie","line_number":191,"full_filename":"sources/broken-crystals/src/main.ts","filename":"src/main.ts","category_groups":["PII","Personal Data"],"source":{"start":191,"end":198,"column":{"start":34,"end":4}},"sink":{"start":191,"end":198,"column":{"start":34,"end":4},"content":""},"parent_line_number":191,"fingerprint":"32208da7f79350b3c4b42d48e444f3a7_0","old_fingerprint":"7dca7ee8a691c421e4b48548c7532163_0","code_extract":"  await server.register(session, {\n    secret: randomBytes(32).toString('hex').slice(0, 32),\n    cookieName: 'connect.sid',\n    ...omitted (buffer value 3)\n      httpOnly: false\n    }\n  });"},{"cwe_ids":["208"],"id":"javascript_lang_observable_timing","title":"Observable Timing Discrepancy","description":"## Description\n\nObservable Timing Discrepancy occurs when the time it takes for certain operations to complete can be measured and observed by attackers. This vulnerability is particularly concerning when operations involve sensitive information, such as password checks or secret comparisons. If attackers can analyze how long these operations take, they might be able to deduce confidential details, putting your data at risk.\n\n## Remediations\n\n- **Do** implement algorithms that process sensitive information in constant time. This approach helps prevent attackers from guessing secrets based on the duration of operations.\n- **Do** use built-in security features and cryptographic libraries that offer functions safe from timing attacks for comparing secret values.\n- **Do not** use direct string comparisons for sensitive information, as this can lead to early termination of the function if a mismatch is found, revealing timing information.\n  ```javascript\n    if (apiToken === \"zDE9ET!TDq2uZx2oM!FD2\") { // unsafe\n      ...\n    }\n  ```\n- **Do not** design application logic that changes execution paths in a manner that could introduce timing discrepancies based on user input or secret values.\n\n## References\n\n- [OWASP Guide to Cryptography](https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html)\n- [MDN Web Docs on SubtleCrypto API](https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto)","documentation_url":"https://docs.bearer.com/reference/rules/javascript_lang_observable_timing","line_number":36,"full_filename":"sources/broken-crystals/src/auth/csrf.guard.ts","filename":"src/auth/csrf.guard.ts","category_groups":["PII","Personal Data"],"source":{"start":36,"end":36,"column":{"start":15,"end":35}},"sink":{"start":36,"end":36,"column":{"start":15,"end":35},"content":""},"parent_line_number":36,"fingerprint":"1aaf02ab232fbea3f233211afdb16d49_0","old_fingerprint":"474417a0bfc0e3703b432a216d061402_0","code_extract":"          if (body.csrf !== fpHash) {"}]}
